(()=>{"use strict";var e={918:(e,t,n)=>{n.d(t,{Z:()=>c});var o=n(81),r=n.n(o),i=n(645),a=n.n(i)()(r());a.push([e.id,"* {\n    margin: 0;\n    padding: 0;\n    font-family: Arial, sans-serif;\n    list-style: none;\n}\n\ncanvas {\n    background-color: #798585;\n    margin: 0;\n    padding: 0;\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n\n#toolbar {\n    position: fixed;\n    z-index: 2;\n    left: 20px;\n    top: 20px;\n}\n\n#create_track_popup {\n    background-color: rgba(86, 87, 159, 0.54);\n    opacity: 100%;\n    position: fixed;\n    display: none;\n    width: 100%;\n    height: 100vh;\n    z-index: 100;\n    justify-content: center;\n    align-items: center;\n}\n\n#create_track_popup form {\n    display: flex;\n    flex-direction: column;\n}\n\n#create_track_popup form label {\n    color: #ffffff;\n}\n\n#create_track_popup form input {\n    margin-bottom: 10px;\n    padding: 3px;\n}\n\nbutton {\n    padding: 4px 8px;\n}\n\n#meta_info {\n    position: fixed;\n    z-index: 1;\n    left: 0;\n    bottom: 0;\n}\n\n#tracks {\n    position: fixed;\n    z-index: 3;\n    right: 20px;\n    top: 20px;\n}\n\n#log {\n    position: fixed;\n    z-index: 4;\n    bottom: 20px;\n    right: 20px;\n}\n\n#log h1 {\n    color: #ff1616;\n}\n\nh1 {\n    color: greenyellow;\n    font-size: 16px;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n}",""]);const c=a},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",o=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),o&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),o&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,o,r,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(o)for(var c=0;c<this.length;c++){var s=this[c][0];null!=s&&(a[s]=!0)}for(var l=0;l<e.length;l++){var u=[].concat(e[l]);o&&a[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),t.push(u))}},t}},81:e=>{e.exports=function(e){return e[1]}},323:(e,t,n)=>{n.r(t),n.d(t,{default:()=>F});var o=n(379),r=n.n(o),i=n(795),a=n.n(i),c=n(569),s=n.n(c),l=n(565),u=n.n(l),d=n(216),f=n.n(d),p=n(589),m=n.n(p),h=n(918),v={};v.styleTagTransform=m(),v.setAttributes=u(),v.insert=s().bind(null,"head"),v.domAPI=a(),v.insertStyleElement=f(),r()(h.Z,v);const F=h.Z&&h.Z.locals?h.Z.locals:void 0},379:e=>{var t=[];function n(e){for(var n=-1,o=0;o<t.length;o++)if(t[o].identifier===e){n=o;break}return n}function o(e,o){for(var i={},a=[],c=0;c<e.length;c++){var s=e[c],l=o.base?s[0]+o.base:s[0],u=i[l]||0,d="".concat(l," ").concat(u);i[l]=u+1;var f=n(d),p={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==f)t[f].references++,t[f].updater(p);else{var m=r(p,o);o.byIndex=c,t.splice(c,0,{identifier:d,updater:m,references:1})}a.push(d)}return a}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var i=o(e=e||[],r=r||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var c=n(i[a]);t[c].references--}for(var s=o(e,r),l=0;l<i.length;l++){var u=n(i[l]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}i=s}}},569:e=>{var t={};e.exports=function(e,n){var o=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,r&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(o,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},492:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(323);const r=o(n(106));var i;!function(e){e[e["#FFC500FF"]=0]="#FFC500FF",e[e["#7BFF00FF"]=1]="#7BFF00FF",e[e["#FF6A00FF"]=2]="#FF6A00FF",e[e["#00FF95FF"]=3]="#00FF95FF",e[e["#00FF33FF"]=4]="#00FF33FF",e[e["#00FFFFFF"]=5]="#00FFFFFF",e[e["#006FFFFF"]=6]="#006FFFFF",e[e["#8400FFFF"]=7]="#8400FFFF",e[e["#FF00F2FF"]=8]="#FF00F2FF",e[e["#FF0073FF"]=9]="#FF0073FF",e[e["#ff0000"]=10]="#ff0000"}(i||(i={}));const a=new Image;a.src=r.default;const c=window.innerWidth,s=window.innerHeight,l="#0048ff";let u=1,d=0,f=0,p=0,m=0;const h={};let v,F=0,y=0,g=0,b=0,x=!1,w=0,_=0;const S=[];let k;const E=[],T={},M=document.querySelector("#mouse_position"),L=document.querySelector("#mouse_in_image_position"),C=document.querySelector("#camera_position"),q=document.querySelector("#camera_offset"),N=document.querySelector("#scale"),$=document.querySelector("#log"),A=document.querySelector("#game_loop_performance"),I=document.querySelector("#tracks_list"),P=document.querySelector("#create_track_popup"),R=document.querySelector("#create_track_form");R&&R.addEventListener("submit",(e=>{e.preventDefault();const t=R.elements,n=t.trackName.value;let o=function(){let e=!1;const t=Object.values(i).filter((e=>isNaN(Number(e))));for(const n of t){for(const t in T)T[t].color===n&&(e=!0);if(!e)return n;e=!1}return""}();if(o||(Y("All colors are used.",!0),o=l),E.push({name:n,updateRate:parseInt(t.trackUpdateRate.value),frames:[]}),T[n]={timer:0,color:o},I){const e=document.createElement("li");e.style.color=o,e.appendChild(document.createTextNode(n));const t=document.createElement("button");t.style.marginLeft="10px",t.onclick=()=>{E.splice(E.findIndex((e=>e.name===n)),1),delete T[n],I.removeChild(e)},t.innerText="Remove",e.appendChild(t);const r=document.createElement("button");r.style.marginLeft="5px",r.onclick=()=>{k=n},r.innerText="Select",e.appendChild(r),I.appendChild(e)}P&&(P.style.display="none"),k=n}));const j=document.querySelector("#create_track_btn");j&&j.addEventListener("click",(e=>{P&&("none"!==P.style.display&&P.style.display?P.style.display="none":(R&&(R.elements.trackName.value=`track${E.length}`),P.style.display="flex"))}));const H=document.querySelector("#cut_animation_btn");H&&H.addEventListener("click",(e=>{!function(){const e=document.createElement("a");e.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(JSON.stringify(E))),e.setAttribute("download","example.txt"),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}()}));const O=document.querySelector("#play_animation_btn");function Y(e,t=!1){if($){const n=t?"#ff2929":"#0fff00",o=new Date;o.setSeconds(o.getSeconds()+3);const r=document.createElement("h1");r.style.color=n,r.innerText=e;const i={message:e,color:n,expiredIn:o,htmlRef:r};S.push(i),$.appendChild(i.htmlRef)}}function z(e){$&&$.removeChild(e)}O&&O.addEventListener("click",(e=>{x=!x,O.textContent=x?"Stop":"Play"}));let X=0;const D=document.querySelector("canvas");if(D){document.addEventListener("keydown",(e=>{var t;if(h[e.key]=!0,!0===h.Control&&"z"===e.key)if(k){const e=E.find((e=>e.name===k));(null===(t=null==e?void 0:e.frames)||void 0===t?void 0:t.length)&&e.frames.pop()}else Y("No one track is selected.",!0);!0===h.Escape&&P&&(P.style.display="none")})),document.addEventListener("keyup",(e=>{h[e.key]=!1})),D.addEventListener("mousedown",(e=>{if(0===e.button&&(h.mouseleft=!0,F=Math.trunc(e.clientX/u),y=Math.trunc(e.clientY/u),!h[" "]))if(E.length)if(k){const t=E.find((e=>e.name===k));(null==t?void 0:t.frames)&&t.frames.push({x:Math.trunc(e.clientX/u)-p,y:Math.trunc(e.clientY/u)-m,w:1,h:1})}else Y("No one track is selected.",!0);else Y(`You need to create at least one track. (${X})`,!0),X++})),D.addEventListener("mouseup",(e=>{d=p,f=m,C&&(C.innerHTML=`camera_pos X: ${d}, Y: ${f}`),0===e.button&&(h.mouseleft=!1)})),document.addEventListener("mouseout",(e=>{0===e.button&&(h.mouseleft=!1)})),document.addEventListener("mouseleave",(e=>{0===e.button&&(h.mouseleft=!1)})),document.addEventListener("mouseover",(e=>{0===e.button&&(h.mouseleft=!1)})),D.addEventListener("mousemove",(e=>{var t;if(g=Math.trunc(e.clientX/u),b=Math.trunc(e.clientY/u),!0===h.mouseleft&&!0===h[" "])p=d+g-F,m=f+b-y,q&&(q.innerHTML=`camera_offset X: ${p}, Y: ${m}`);else if(h.mouseleft&&!x&&E.length)if(k){const e=E.find((e=>e.name===k));(null===(t=null==e?void 0:e.frames)||void 0===t?void 0:t.length)&&(e.frames[e.frames.length-1].w=g-F,e.frames[e.frames.length-1].h=b-y)}else Y("No one track is selected.",!0);M&&(M.innerHTML=`mouse_pos X: ${g}, Y: ${b}`),L&&(L.innerHTML=`mouse_ii_pos X: ${g-p}, Y: ${b-m}`)})),document.addEventListener("wheel",(e=>{e.deltaY<0?u+=.5:u-=.5,u=Math.max(1,u),N&&(N.innerHTML=`scale: ${u}`)}));const e=D.getContext("2d");if(e){e.canvas.width=c,e.canvas.height=s,e.imageSmoothingEnabled=!1,v=performance.now();const t=()=>{w=performance.now()-v,A&&_>=100&&(A.innerHTML=`FPS: ${Math.trunc(1e3/w)}`,_=0),v=performance.now();for(const e in T)T[e].timer+=w;if(_+=w,e.clearRect(0,0,c,s),!x){if(e.drawImage(a,0,0,a.width,a.height,p*u,m*u,a.width*u,a.height*u),u>=7){e.strokeStyle="#000";for(let t=0;t<a.width*u;t+=u)e.beginPath(),e.moveTo(t+p*u,m*u),e.lineTo(t+p*u,a.height*u+m*u),e.stroke();for(let t=0;t<a.height*u;t+=u)e.beginPath(),e.moveTo(p*u,t+m*u),e.lineTo(a.width*u+p*u,t+m*u),e.stroke()}for(const t of E){const n=T[t.name];for(const o of t.frames)n&&(e.strokeStyle=n.color||l),e.strokeRect(o.x*u+p*u,o.y*u+m*u,o.w*u,o.h*u)}}if(x)for(const[t,n]of E.entries()){const o=n.frames,r=T[n.name];if(o.length&&r){if(r.timer>=n.updateRate){if(o.length>1){const e=o.shift();e&&o.push(e)}r.timer=0}e.drawImage(a,o[o.length-1].x,o[o.length-1].y,o[o.length-1].w,o[o.length-1].h,(p+300*t)*u,m*u,o[o.length-1].w*u,o[o.length-1].h*u)}}for(const[e,t]of S.entries())if(new Date>=t.expiredIn){const t=S.splice(e,1);(null==t?void 0:t.length)&&z(t[0].htmlRef)}requestAnimationFrame(t)};requestAnimationFrame(t)}}},106:(e,t,n)=>{e.exports=n.p+"ec62c4751b3102633f18.png"}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={id:o,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var r=o.length-1;r>-1&&!e;)e=o[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n.nc=void 0,n(492)})();